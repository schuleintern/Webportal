<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SchuleIntern: Upload/framework/lib/ical/includes/date.php Quellcode</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SchuleIntern
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Erzeugt von Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Suchen');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Suchen');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_61632385f601d7770e35e4c8904ddc33.html">Upload</a></li><li class="navelem"><a class="el" href="dir_812cdbf44ae3e957979ea7d20d9682e9.html">framework</a></li><li class="navelem"><a class="el" href="dir_25f7db0a5a969d00f4981acb1578de3a.html">lib</a></li><li class="navelem"><a class="el" href="dir_8c2bf97883123f540abbfca88bd92722.html">ical</a></li><li class="navelem"><a class="el" href="dir_ca8d9f375eeb3d9638dcfcb0f2ba3d2b.html">includes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">date.php</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?php</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// No direct access</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;defined(<span class="stringliteral">&#39;_ZAPCAL&#39;</span>) or die( &#39;Restricted access&#39; );</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="class_z_date_helper.html">   16</a></span>&#160;class <a class="code" href="class_z_date_helper.html">ZDateHelper</a> {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a07c2f5d03c39f5b0ad4f9309f567e3a0">   27</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a07c2f5d03c39f5b0ad4f9309f567e3a0">DayInMonth</a>($month, $year) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;       $daysInMonth = array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;       <span class="keywordflow">if</span> ($month != 2) <span class="keywordflow">return</span> $daysInMonth[$month - 1];</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;       <span class="keywordflow">return</span> (checkdate($month, 29, $year)) ? 29 : 28;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a9026d7cb38c1f279754f7d43fb47572a">   42</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a9026d7cb38c1f279754f7d43fb47572a">isToday</a>($date, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&#39;Y-m-d&#39;</span>, $date) == gmdate(<span class="stringliteral">&#39;Y-m-d&#39;</span>, $now);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#addd7e6580a5e38133d5915a00d36decb">   58</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#addd7e6580a5e38133d5915a00d36decb">isBeforeToday</a>($date, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>){</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">return</span> mktime(0,0,0,date(<span class="charliteral">&#39;m&#39;</span>,$now),date(<span class="charliteral">&#39;d&#39;</span>,$now),date(<span class="charliteral">&#39;Y&#39;</span>,$now)) &gt;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            mktime(0,0,0,date(<span class="charliteral">&#39;m&#39;</span>,$date),date(<span class="charliteral">&#39;d&#39;</span>,$date),date(<span class="charliteral">&#39;Y&#39;</span>,$now));</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a6b6623063dc65177264c8c1f769f5cdb">   75</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a6b6623063dc65177264c8c1f769f5cdb">isAfterToday</a>($date, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>){</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">return</span> mktime(0,0,0,date(<span class="charliteral">&#39;m&#39;</span>,$now),date(<span class="charliteral">&#39;d&#39;</span>,$now),date(<span class="charliteral">&#39;Y&#39;</span>,$now)) &lt;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            mktime(0,0,0,date(<span class="charliteral">&#39;m&#39;</span>,$date),date(<span class="charliteral">&#39;d&#39;</span>,$date),date(<span class="charliteral">&#39;Y&#39;</span>,$now));</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#aec94814bd48ff1c53fc0c7a68b5d00d9">   92</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#aec94814bd48ff1c53fc0c7a68b5d00d9">isTomorrow</a>($date, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&#39;Y-m-d&#39;</span>, $date) == gmdate(<span class="stringliteral">&#39;Y-m-d&#39;</span>, $now + 60 * 60 * 24);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#ac64e4613edfaf5e0975c85ff30959387">  111</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#ac64e4613edfaf5e0975c85ff30959387">isFuture</a>($date, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>){</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">return</span> $date &gt; $now;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#af533ff8e331d811b7d789c5cbf76b068">  130</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#af533ff8e331d811b7d789c5cbf76b068">isPast</a>($date, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">return</span> $date &lt; $now;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a6122b39577d89c503d1c20a445fc1eff">  144</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a6122b39577d89c503d1c20a445fc1eff">now</a>($tzid = <span class="stringliteral">&quot;UTC&quot;</span>){</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        $dtz = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        $dt = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;now&quot;</span>, $dtz);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        $now = time() + $dtz-&gt;getOffset($dt);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> $now;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a8b7c2fb18fe8636c447968640551aa7c">  158</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a8b7c2fb18fe8636c447968640551aa7c">isWeekend</a>($date) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        $dow = gmdate(<span class="charliteral">&#39;w&#39;</span>,$date);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">return</span> $dow == 0 || $dow == 6;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a40b4ee29889ec7c6444648bd4e7bbd99">  170</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a40b4ee29889ec7c6444648bd4e7bbd99">toSqlDateTime</a>($t = 0)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        date_default_timezone_set(<span class="stringliteral">&#39;GMT&#39;</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">if</span>($t == 0)</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span>,self::now());</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span>, $t);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a52d3743449d3e0004b1a0f17d6c70cab">  185</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a52d3743449d3e0004b1a0f17d6c70cab">toSqlDate</a>($t = 0)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        date_default_timezone_set(<span class="stringliteral">&#39;GMT&#39;</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span>($t == 0)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&#39;Y-m-d&#39;</span>,self::now());</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&#39;Y-m-d&#39;</span>, $t);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a404f7e1c78c663b1f2ce4065f5bec5cd">  200</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a404f7e1c78c663b1f2ce4065f5bec5cd">fromiCaltoUnixDateTime</a>($datetime) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="comment">// first check format</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            $formats = array();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            $formats[] = <span class="stringliteral">&quot;/[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]/&quot;</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            $formats[] = <span class="stringliteral">&quot;/[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]T[0-9][0-9][0-9][0-9][0-9][0-9]/&quot;</span>;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            $formats[] = <span class="stringliteral">&quot;/[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]T[0-9][0-9][0-9][0-9][0-9][0-9]Z/&quot;</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            $ok = <span class="keyword">false</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">foreach</span>($formats as $format){</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <span class="keywordflow">if</span>(preg_match($format,$datetime)){</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    $ok = <span class="keyword">true</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span>(!$ok)</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            $year = substr($datetime,0,4);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            $month = substr($datetime,4,2);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            $day = substr($datetime,6,2);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            $hour = 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            $minute = 0;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            $second = 0;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span>(strlen($datetime) &gt; 8 &amp;&amp; $datetime{8} == <span class="stringliteral">&quot;T&quot;</span>) {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                $hour = substr($datetime,9,2);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                $minute = substr($datetime,11,2);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                $second = substr($datetime,13,2);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">return</span> gmmktime($hour, $minute, $second, $month, $day, $year);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#aac3b0504ccd4a287890e72c98b0b38b1">  236</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#aac3b0504ccd4a287890e72c98b0b38b1">fromUnixDateTimetoiCal</a>($datetime){</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        date_default_timezone_set(<span class="stringliteral">&#39;GMT&#39;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&quot;Ymd\THis&quot;</span>,$datetime);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a79c1056abc3d6c5d95e516e3de6bf76e">  248</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a79c1056abc3d6c5d95e516e3de6bf76e">iCalDurationtoSeconds</a>($duration) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        $secs = 0;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">if</span>($duration{0} == <span class="stringliteral">&quot;P&quot;</span>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            $duration = str_replace(array(<span class="stringliteral">&quot;H&quot;</span>,<span class="stringliteral">&quot;M&quot;</span>,<span class="stringliteral">&quot;S&quot;</span>,<span class="stringliteral">&quot;T&quot;</span>,<span class="stringliteral">&quot;D&quot;</span>,<span class="stringliteral">&quot;W&quot;</span>,<span class="stringliteral">&quot;P&quot;</span>),array(<span class="stringliteral">&quot;H,&quot;</span>,<span class="stringliteral">&quot;M,&quot;</span>,<span class="stringliteral">&quot;S,&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;D,&quot;</span>,<span class="stringliteral">&quot;W,&quot;</span>,<span class="stringliteral">&quot;&quot;</span>),$duration);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            $dur2 = explode(<span class="stringliteral">&quot;,&quot;</span>,$duration);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">foreach</span>($dur2 as $dur){</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                $val=intval($dur);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="keywordflow">if</span>(strlen($dur) &gt; 0){</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                    <span class="keywordflow">switch</span>($dur{strlen($dur) - 1}) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;H&quot;</span>:</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                            $secs += 60*60 * $val;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;M&quot;</span>:</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                            $secs += 60 * $val;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;S&quot;</span>:</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                            $secs += $val;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;D&quot;</span>:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                            $secs += 60*60*24 * $val;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&quot;W&quot;</span>:</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                            $secs += 60*60*24*7 * $val;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                }</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">return</span> $secs;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#abd18a3ed0bc7ad987c68ad39943fa486">  290</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#abd18a3ed0bc7ad987c68ad39943fa486">inDay</a>($daystart, $begin, $end)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="comment">//$dayend = $daystart + 60*60*24 - 60;</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">// add 1 day to determine end of day</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// don&#39;t use 24 hours, since twice a year DST Sundays are 23 hours and 25 hours in length</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">// adding 1 day takes this into account</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        $dayend = self::addDate($daystart, 0,0,0,0,1,0);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        $end = max($begin, $end); <span class="comment">// $end can&#39;t be less than $begin</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        $inday = </div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            ($daystart &lt;= $begin &amp;&amp; $begin &lt; $dayend)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            ||($daystart &lt; $end &amp;&amp; $end &lt; $dayend)</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            ||($begin &lt;= $daystart &amp;&amp; $end &gt; $dayend)</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            ;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">return</span> $inday;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#ac366b0b42b39f55be33ef5b528cfac6a">  314</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#ac366b0b42b39f55be33ef5b528cfac6a">toUnixDate</a>($datetime)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            $year = substr($datetime,0,4);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            $month = substr($datetime,5,2);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            $day = substr($datetime,8,2);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">return</span> mktime(0, 0, 0, $month, $day, $year);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a99a5d6dacb113f1b30aa8c74439402f7">  330</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a99a5d6dacb113f1b30aa8c74439402f7">toUnixDateTime</a>($datetime)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// convert to absolute dates if neccessary</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        $datetime = self::getAbsDate($datetime);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        $year = substr($datetime,0,4);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        $month = substr($datetime,5,2);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        $day = substr($datetime,8,2);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        $hour = 0;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        $minute = 0;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        $second = 0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span>(strlen($datetime) &gt; 10) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            $hour = substr($datetime,11,2);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            $minute = substr($datetime,14,2);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            $second = substr($datetime,17,2);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">return</span> gmmktime($hour, $minute, $second, $month, $day, $year);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a26dcb637376ca81977e693c547466a30">  367</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a26dcb637376ca81977e693c547466a30">addDate</a>($date, $hour, $min, $sec, $month, $day, $year, $tzid = <span class="stringliteral">&quot;UTC&quot;</span>) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        date_default_timezone_set($tzid);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        $sqldate = self::toSQLDateTime($date);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        $tdate = array();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        $tdate[<span class="stringliteral">&quot;year&quot;</span>] = substr($sqldate,0,4);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        $tdate[<span class="stringliteral">&quot;mon&quot;</span>] = substr($sqldate,5,2);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        $tdate[<span class="stringliteral">&quot;mday&quot;</span>] = substr($sqldate,8,2);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        $tdate[<span class="stringliteral">&quot;hours&quot;</span>] = substr($sqldate,11,2);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        $tdate[<span class="stringliteral">&quot;minutes&quot;</span>] = substr($sqldate,14,2);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        $tdate[<span class="stringliteral">&quot;seconds&quot;</span>] = substr($sqldate,17,2);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        $newdate=mktime($tdate[<span class="stringliteral">&quot;hours&quot;</span>] + $hour, $tdate[<span class="stringliteral">&quot;minutes&quot;</span>] + $min, $tdate[<span class="stringliteral">&quot;seconds&quot;</span>] + $sec, $tdate[<span class="stringliteral">&quot;mon&quot;</span>] + $month, $tdate[<span class="stringliteral">&quot;mday&quot;</span>] + $day, $tdate[<span class="stringliteral">&quot;year&quot;</span>] + $year);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        date_default_timezone_set(<span class="stringliteral">&quot;UTC&quot;</span>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">//echo self::toSQLDateTime($date) . &quot; =&gt; &quot; . self::toSQLDateTime($newdate) . &quot; ($hour:$min:$sec $month/$day/$year)&lt;br/&gt;\n&quot;;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">return</span> $newdate;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a19234db79253cd211a9af517b655d5a2">  400</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a19234db79253cd211a9af517b655d5a2">getDateFromDay</a>($date, $week, $wday,$tzid=<span class="stringliteral">&quot;UTC&quot;</span>) {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">//echo &quot;getDateFromDay(&quot; . self::toSqlDateTime($date) . &quot;,$week,$wday)&lt;br/&gt;\n&quot;;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">// determine first day in month</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        $tdate = getdate($date);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        $monthbegin = gmmktime(0,0,0, $tdate[<span class="stringliteral">&quot;mon&quot;</span>],1,$tdate[<span class="stringliteral">&quot;year&quot;</span>]);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        $monthend = self::addDate($monthbegin, 0,0,0,1,-1,0,$tzid); <span class="comment">// add 1 month and subtract 1 day</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        $day = self::addDate($date,0,0,0,0,1 - $tdate[<span class="stringliteral">&quot;mday&quot;</span>],0,$tzid);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        $month = array(array());</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">while</span>($day &lt;= $monthend) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            $tdate=getdate($day);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            $month[$tdate[<span class="stringliteral">&quot;wday&quot;</span>]][]=$day;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="comment">//echo self::toSQLDateTime($day) . &quot;&lt;br/&gt;\n&quot;;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            $day = self::addDate($day, 0,0,0,0,1,0,$tzid); <span class="comment">// add 1 day</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        $dayinmonth=0;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">if</span>($week &gt;= 0)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            $dayinmonth = $month[$wday][$week];</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            $dayinmonth = $month[$wday][count($month[$wday]) - 1];</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">//echo &quot;return &quot; . self::toSQLDateTime($dayinmonth);</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">//exit;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">return</span> $dayinmonth;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#afcea2d531550680027f1c4301613d6f6">  433</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#afcea2d531550680027f1c4301613d6f6">toLocalDateTime</a>($sqldate, $tzid = <span class="stringliteral">&quot;UTC&quot;</span> ){</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">try</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            $timezone = <span class="keyword">new</span> <a class="code" href="namespace_date_time_zone.html">DateTimeZone</a>($tzid);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">catch</span>(<a class="code" href="namespace_exception.html">Exception</a> $e)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="comment">// bad time zone specified</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">return</span> $sqldate;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        $udate = self::toUnixDateTime($sqldate);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        $daydatetime = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>(<span class="stringliteral">&quot;@&quot;</span> . $udate);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        $tzoffset = $timezone-&gt;getOffset($daydatetime);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">return</span> self::toSqlDateTime($udate + $tzoffset);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#ae48ebb7e1e9ed5de7c0d3254be081ffb">  458</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#ae48ebb7e1e9ed5de7c0d3254be081ffb">toUTCDateTime</a>($sqldate, $tzid = <span class="stringliteral">&quot;UTC&quot;</span> ){</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        date_default_timezone_set(<span class="stringliteral">&quot;UTC&quot;</span>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">try</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            $date = <span class="keyword">new</span> <a class="code" href="namespace_date_time.html">DateTime</a>($sqldate, $tzid);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">catch</span>(<a class="code" href="namespace_exception.html">Exception</a> $e)</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        {</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="comment">// bad time zone specified</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keywordflow">return</span> $sqldate;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        $offset = $date-&gt;getOffsetFromGMT();</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span>($offset &gt;= 0)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            $date-&gt;sub(<span class="keyword">new</span> <a class="code" href="namespace_date_interval.html">DateInterval</a>(<span class="stringliteral">&quot;PT&quot;</span>.$offset.<span class="stringliteral">&quot;S&quot;</span>));</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            $date-&gt;add(<span class="keyword">new</span> <a class="code" href="namespace_date_interval.html">DateInterval</a>(<span class="stringliteral">&quot;PT&quot;</span>.abs($offset).<span class="stringliteral">&quot;S&quot;</span>));</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">return</span> $date-&gt;toSql(<span class="keyword">true</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a30f7c4e722fd5947833ab78e6b52e8fa">  492</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a30f7c4e722fd5947833ab78e6b52e8fa">getAbsDate</a>($date,$rdate = <span class="stringliteral">&quot;&quot;</span>){</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">if</span>(str_replace(array(<span class="stringliteral">&quot;y&quot;</span>,<span class="stringliteral">&quot;m&quot;</span>,<span class="stringliteral">&quot;d&quot;</span>,<span class="stringliteral">&quot;h&quot;</span>,<span class="stringliteral">&quot;n&quot;</span>),<span class="stringliteral">&quot;&quot;</span>,strtolower($date)) != strtolower($date)){</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            date_default_timezone_set(<span class="stringliteral">&quot;UTC&quot;</span>);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">if</span>($rdate == <span class="stringliteral">&quot;&quot;</span>)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                $udate = time();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                $udate = self::toUnixDateTime($rdate);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            $values=explode(<span class="stringliteral">&quot;,&quot;</span>,strtolower($date));</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            $y = 0;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            $m = 0;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            $d = 0;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            $h = 0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            $n = 0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">foreach</span>($values as $value){</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                $rtype = substr($value,strlen($value)-1);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                $rvalue = intval(substr($value,0,strlen($value) - 1));</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keywordflow">switch</span>($rtype){</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        $y = $rvalue;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        $m = $rvalue;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        $d = $rvalue;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        $h = $rvalue;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        $n = $rvalue;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="comment">// for &quot;-&quot; values, move to start of day , otherwise, move to end of day</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <span class="keywordflow">if</span>($rvalue[0] == <span class="charliteral">&#39;-&#39;</span>)</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    $udate = mktime(0,0,0,date(<span class="charliteral">&#39;m&#39;</span>,$udate),date(<span class="charliteral">&#39;d&#39;</span>,$udate),date(<span class="charliteral">&#39;Y&#39;</span>,$udate));</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    $udate = mktime(0,-1,0,date(<span class="charliteral">&#39;m&#39;</span>,$udate),date(<span class="charliteral">&#39;d&#39;</span>,$udate)+1,date(<span class="charliteral">&#39;Y&#39;</span>,$udate));</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                $udate = self::addDate($udate,$h,$n,0,$m,$d,$y);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            $date = self::toSqlDateTime($udate);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">return</span> $date;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#a128b69a45ab5b5eeedda0cd93f6a9e05">  544</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#a128b69a45ab5b5eeedda0cd93f6a9e05">toiCalDateTime</a>($datetime = null){</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        date_default_timezone_set(<span class="stringliteral">&#39;UTC&#39;</span>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">if</span>($datetime == null)</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            $datetime = time();</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&quot;Ymd\THis&quot;</span>,$datetime);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="class_z_date_helper.html#aac48eb1fc2a5a8206b3c18e46f121a14">  558</a></span>&#160;    <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_z_date_helper.html#aac48eb1fc2a5a8206b3c18e46f121a14">toiCalDate</a>($datetime = null){</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        date_default_timezone_set(<span class="stringliteral">&#39;UTC&#39;</span>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">if</span>($datetime == null)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            $datetime = time();</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">return</span> gmdate(<span class="stringliteral">&quot;Ymd&quot;</span>,$datetime);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="class_z_date_helper_html_aec94814bd48ff1c53fc0c7a68b5d00d9"><div class="ttname"><a href="class_z_date_helper.html#aec94814bd48ff1c53fc0c7a68b5d00d9">ZDateHelper\isTomorrow</a></div><div class="ttdeci">static isTomorrow($date, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00092">date.php:92</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a8b7c2fb18fe8636c447968640551aa7c"><div class="ttname"><a href="class_z_date_helper.html#a8b7c2fb18fe8636c447968640551aa7c">ZDateHelper\isWeekend</a></div><div class="ttdeci">static isWeekend($date)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00158">date.php:158</a></div></div>
<div class="ttc" id="class_z_date_helper_html_addd7e6580a5e38133d5915a00d36decb"><div class="ttname"><a href="class_z_date_helper.html#addd7e6580a5e38133d5915a00d36decb">ZDateHelper\isBeforeToday</a></div><div class="ttdeci">static isBeforeToday($date, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00058">date.php:58</a></div></div>
<div class="ttc" id="namespace_date_time_html"><div class="ttname"><a href="namespace_date_time.html">DateTime</a></div></div>
<div class="ttc" id="namespace_date_interval_html"><div class="ttname"><a href="namespace_date_interval.html">DateInterval</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a99a5d6dacb113f1b30aa8c74439402f7"><div class="ttname"><a href="class_z_date_helper.html#a99a5d6dacb113f1b30aa8c74439402f7">ZDateHelper\toUnixDateTime</a></div><div class="ttdeci">static toUnixDateTime($datetime)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00330">date.php:330</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a6122b39577d89c503d1c20a445fc1eff"><div class="ttname"><a href="class_z_date_helper.html#a6122b39577d89c503d1c20a445fc1eff">ZDateHelper\now</a></div><div class="ttdeci">static now($tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00144">date.php:144</a></div></div>
<div class="ttc" id="class_z_date_helper_html_aac3b0504ccd4a287890e72c98b0b38b1"><div class="ttname"><a href="class_z_date_helper.html#aac3b0504ccd4a287890e72c98b0b38b1">ZDateHelper\fromUnixDateTimetoiCal</a></div><div class="ttdeci">static fromUnixDateTimetoiCal($datetime)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00236">date.php:236</a></div></div>
<div class="ttc" id="namespace_exception_html"><div class="ttname"><a href="namespace_exception.html">Exception</a></div></div>
<div class="ttc" id="namespace_date_time_zone_html"><div class="ttname"><a href="namespace_date_time_zone.html">DateTimeZone</a></div></div>
<div class="ttc" id="class_z_date_helper_html_aac48eb1fc2a5a8206b3c18e46f121a14"><div class="ttname"><a href="class_z_date_helper.html#aac48eb1fc2a5a8206b3c18e46f121a14">ZDateHelper\toiCalDate</a></div><div class="ttdeci">static toiCalDate($datetime=null)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00558">date.php:558</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a404f7e1c78c663b1f2ce4065f5bec5cd"><div class="ttname"><a href="class_z_date_helper.html#a404f7e1c78c663b1f2ce4065f5bec5cd">ZDateHelper\fromiCaltoUnixDateTime</a></div><div class="ttdeci">static fromiCaltoUnixDateTime($datetime)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00200">date.php:200</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a07c2f5d03c39f5b0ad4f9309f567e3a0"><div class="ttname"><a href="class_z_date_helper.html#a07c2f5d03c39f5b0ad4f9309f567e3a0">ZDateHelper\DayInMonth</a></div><div class="ttdeci">static DayInMonth($month, $year)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00027">date.php:27</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a52d3743449d3e0004b1a0f17d6c70cab"><div class="ttname"><a href="class_z_date_helper.html#a52d3743449d3e0004b1a0f17d6c70cab">ZDateHelper\toSqlDate</a></div><div class="ttdeci">static toSqlDate($t=0)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00185">date.php:185</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a6b6623063dc65177264c8c1f769f5cdb"><div class="ttname"><a href="class_z_date_helper.html#a6b6623063dc65177264c8c1f769f5cdb">ZDateHelper\isAfterToday</a></div><div class="ttdeci">static isAfterToday($date, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00075">date.php:75</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a79c1056abc3d6c5d95e516e3de6bf76e"><div class="ttname"><a href="class_z_date_helper.html#a79c1056abc3d6c5d95e516e3de6bf76e">ZDateHelper\iCalDurationtoSeconds</a></div><div class="ttdeci">static iCalDurationtoSeconds($duration)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00248">date.php:248</a></div></div>
<div class="ttc" id="class_z_date_helper_html_abd18a3ed0bc7ad987c68ad39943fa486"><div class="ttname"><a href="class_z_date_helper.html#abd18a3ed0bc7ad987c68ad39943fa486">ZDateHelper\inDay</a></div><div class="ttdeci">static inDay($daystart, $begin, $end)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00290">date.php:290</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a26dcb637376ca81977e693c547466a30"><div class="ttname"><a href="class_z_date_helper.html#a26dcb637376ca81977e693c547466a30">ZDateHelper\addDate</a></div><div class="ttdeci">static addDate($date, $hour, $min, $sec, $month, $day, $year, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00367">date.php:367</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a128b69a45ab5b5eeedda0cd93f6a9e05"><div class="ttname"><a href="class_z_date_helper.html#a128b69a45ab5b5eeedda0cd93f6a9e05">ZDateHelper\toiCalDateTime</a></div><div class="ttdeci">static toiCalDateTime($datetime=null)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00544">date.php:544</a></div></div>
<div class="ttc" id="class_z_date_helper_html_afcea2d531550680027f1c4301613d6f6"><div class="ttname"><a href="class_z_date_helper.html#afcea2d531550680027f1c4301613d6f6">ZDateHelper\toLocalDateTime</a></div><div class="ttdeci">static toLocalDateTime($sqldate, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00433">date.php:433</a></div></div>
<div class="ttc" id="class_z_date_helper_html_ac366b0b42b39f55be33ef5b528cfac6a"><div class="ttname"><a href="class_z_date_helper.html#ac366b0b42b39f55be33ef5b528cfac6a">ZDateHelper\toUnixDate</a></div><div class="ttdeci">static toUnixDate($datetime)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00314">date.php:314</a></div></div>
<div class="ttc" id="class_z_date_helper_html"><div class="ttname"><a href="class_z_date_helper.html">ZDateHelper</a></div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00016">date.php:16</a></div></div>
<div class="ttc" id="class_z_date_helper_html_af533ff8e331d811b7d789c5cbf76b068"><div class="ttname"><a href="class_z_date_helper.html#af533ff8e331d811b7d789c5cbf76b068">ZDateHelper\isPast</a></div><div class="ttdeci">static isPast($date, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00130">date.php:130</a></div></div>
<div class="ttc" id="class_z_date_helper_html_ac64e4613edfaf5e0975c85ff30959387"><div class="ttname"><a href="class_z_date_helper.html#ac64e4613edfaf5e0975c85ff30959387">ZDateHelper\isFuture</a></div><div class="ttdeci">static isFuture($date, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00111">date.php:111</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a19234db79253cd211a9af517b655d5a2"><div class="ttname"><a href="class_z_date_helper.html#a19234db79253cd211a9af517b655d5a2">ZDateHelper\getDateFromDay</a></div><div class="ttdeci">static getDateFromDay($date, $week, $wday, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00400">date.php:400</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a9026d7cb38c1f279754f7d43fb47572a"><div class="ttname"><a href="class_z_date_helper.html#a9026d7cb38c1f279754f7d43fb47572a">ZDateHelper\isToday</a></div><div class="ttdeci">static isToday($date, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00042">date.php:42</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a40b4ee29889ec7c6444648bd4e7bbd99"><div class="ttname"><a href="class_z_date_helper.html#a40b4ee29889ec7c6444648bd4e7bbd99">ZDateHelper\toSqlDateTime</a></div><div class="ttdeci">static toSqlDateTime($t=0)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00170">date.php:170</a></div></div>
<div class="ttc" id="class_z_date_helper_html_ae48ebb7e1e9ed5de7c0d3254be081ffb"><div class="ttname"><a href="class_z_date_helper.html#ae48ebb7e1e9ed5de7c0d3254be081ffb">ZDateHelper\toUTCDateTime</a></div><div class="ttdeci">static toUTCDateTime($sqldate, $tzid=&quot;UTC&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00458">date.php:458</a></div></div>
<div class="ttc" id="class_z_date_helper_html_a30f7c4e722fd5947833ab78e6b52e8fa"><div class="ttname"><a href="class_z_date_helper.html#a30f7c4e722fd5947833ab78e6b52e8fa">ZDateHelper\getAbsDate</a></div><div class="ttdeci">static getAbsDate($date, $rdate=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="ical_2includes_2date_8php_source.html#l00492">date.php:492</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Erzeugt von &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
